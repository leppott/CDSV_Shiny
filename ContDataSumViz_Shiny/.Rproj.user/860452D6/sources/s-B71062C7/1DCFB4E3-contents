#
# This is the user-interface definition of ContDataSumViz Shiny web application. You can
# run the application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
# 
#    http://shiny.rstudio.com/
#

library(shiny)
library(shinyjs)
library(shinyalert)
library(shinythemes)
library(shinydashboard)
library(ggplot2)
library(ggthemes)
#library(plotly)
#library(shinycustomloader)
library(shinycssloaders)

# Define UI for application
options(spinner.color.background="#ffffff",spinner.size=1)
shinyUI(fluidPage(
  
  theme = 'styles.css',
  useShinyjs(),
  
  # main panel for variable selection
  mainPanel(width = 12,
            
            tags$style("#big-heading {font-size:15px;color:black;font-style:bold;display:block; }"),
            
            # spacing
            fluidRow(p()),
            
            # top controls  
            fluidRow(
              
              column(width = 12,
                     actionButton('reset all', label = img(src = "ContDataSumViz_banner_updated.png", width = '100%'), width = '100%')
              )
              ),
              
            
            fluidRow(p(),
                     
                     tabsetPanel(
                       
                       tabPanel("Upload Data", 
                                
                                fluidPage(
                                  
                                  fluidRow(
                                    
                                    column(width = 12,
                                           
                                           sidebarLayout(
                                             sidebarPanel(width=3,
                                                          fileInput("uploaded_data_file",label=h4(id="big-heading","Upload your data"),multiple=FALSE,
                                                                    accept = c("text/csv","text/comma-separated-values,text/plain",".csv")),
                                                          hr(),
                                                          actionButton(inputId="uploadId", label= "Use this file",style="color:black;background-color:grey"),
                                                          hr(),
                                                          uiOutput("manage"),
                                                          hr(),
                                                          uiOutput("siteType"),
                                                          hr(),
                                                          uiOutput("select"), 
                                                          hr(),
                                                          uiOutput("display_button")
                                                          
                                                          
                                                          
                                                          
                                             ),
                                             mainPanel(width=9,
                                                       uiOutput("display_raw_ts")
                                               ) # mainPanel end
                                             
                                           ) # sidebarLayout end
                                           
                                    ), #column close
                                    
                                    column(width = 12,
                                             tableOutput("contents")
                                             
                                         
                                           
                                    ), #column close
                                    
                                    
                                  ) #fluidRow close
                                )  #fluidPage close
                       ),  # tabPanel end 
                       
                       
                       tabPanel("Data Exploration", 
                                
                                fluidPage(
                                  
                                  fluidRow(
                                    
                                    tabsetPanel( id="tabset",
                                                 tags$head(tags$style(HTML(".radio-inline {margin-right: 40px;}"))),
                                                 tabPanel("All parameters", value="all_parameters_tab",br(),
                                                          tabsetPanel(id="all_parameters_subtabs",
                                                                      tabPanel("Summary tables", value="tab_periodStats",br(),                     
                                                          br(),
                                                          column(width = 12,
                                                                 sidebarLayout(
                                                                   sidebarPanel(width=3,
                                                                                hr(),
                                                                                uiOutput("date_input"),
                                                                                hr(),
                                                                                uiOutput("date_format_select"),
                                                                                hr(),
                                                                                uiOutput("period_N_input"), 
                                                                                hr(),
                                                                                uiOutput("period_unit_input"),
                                                                                hr(),
                                                                                uiOutput("param_name_select"),
                                                                                hr(),
                                                                                uiOutput("datetime_name_select"),
                                                                                hr(),
                                                                                uiOutput("datetime_format_select"),
                                                                                hr(),
                                                                                uiOutput("threshold_input"),
                                                                                hr(),
                                                                                uiOutput("report_format_select"),
                                                                                hr(),
                                                                                uiOutput("display_periodStats_button")
                                                                   ),
                                                                   mainPanel(width=9,
                                                                             column(width=9,uiOutput("display_plot_periodStats_1")),
                                                                             column(width=9,uiOutput("display_plot_periodStats_2"))
                                                                   ) # mainPanel end
                                                                   
                                                                 ) # sidebarLayout end
                                                                 
                                                          ), #column close
                                                                      ), # tabPanel 1 end
                                                          
                                                          tabPanel("Time series plots", value="tab_time_series",br(),
                                                                   column(width = 12,
                                                                          sidebarLayout(
                                                                            sidebarPanel(width=3,
                                                                                         hr(),
                                                                                         uiOutput("time_series_input_1"),
                                                                                         hr(),
                                                                                         uiOutput("time_series_input_2"),
                                                                                         hr(),
                                                                                         uiOutput("time_series_input_3")
                                                                                         
                                                                            ),
                                                                            mainPanel(width=9,
                                                                                      column(width=9,uiOutput("display_time_series"))
                                                                                      
                                                                            ) # mainPanel end
                                                                            
                                                                          ) # sidebarLayout end
                                                                          
                                                                   ), #column close
                                                                   
                                                          ), #tabPanel 2 end
                                                          
                                                          tabPanel("Box plots", value="tab_box",br(),
                                                                   column(width = 12,
                                                                          sidebarLayout(
                                                                            sidebarPanel(width=3,
                                                                                         hr(),
                                                                                         uiOutput("box_input_1"),
                                                                                         hr(),
                                                                                         uiOutput("box_input_2"),
                                                                                         
                                                                            ),
                                                                            mainPanel(width=9,
                                                                                      column(width=9,uiOutput("display_box_plots"))
                                                                                      
                                                                            ) # mainPanel end
                                                                            
                                                                          ) # sidebarLayout end
                                                                          
                                                                   ), #column close
                                                                   
                                                          ), #tabPanel 3 end
                                                          
                                                          tabPanel("CDFs", value="tab_CDF",br(),
                                                                   column(width = 12,
                                                                          sidebarLayout(
                                                                            sidebarPanel(width=3,
                                                                                         hr(),
                                                                                         uiOutput("CDF_xlab_input"),
                                                                                         hr(),
                                                                                         uiOutput("CDF_title_input"),
                                                                                         hr(),
                                                                                         uiOutput("CDF_hist_column_select"), 
                                                                                         hr(),
                                                                                         uiOutput("display_CDF_button")
                                                                            ),
                                                                            mainPanel(width=9,
                                                                                      column(width=9,uiOutput("display_plot_density")),
                                                                                      column(width=9,uiOutput("display_plot_CDF"))
                                                                                      
                                                                            ) # mainPanel end
                                                                            
                                                                          ) # sidebarLayout end
                                                                          
                                                                   ), #column close
                                                                   
                                                          ), #tabPanel 4 end
                                                          
                                                          tabPanel("Raster graphs", value="tab_raster",br(),
                                                                   column(width = 12,
                                                                          sidebarLayout(
                                                                            sidebarPanel(width=3,
                                                                                         hr(),
                                                                                         uiOutput("raster_input_1"),
                                                                                         hr(),
                                                                                         uiOutput("raster_input_2"),
                                                                                         
                                                                            ),
                                                                            mainPanel(width=9,
                                                                                      column(width=9,uiOutput("display_raster_graphs"))
                                                                                      
                                                                            ) # mainPanel end
                                                                            
                                                                          ) # sidebarLayout end
                                                                          
                                                                   ), #column close
                                                                   
                                                          ), #tabPanel 5 end
                                                          
                                                          tabPanel("Climate spiral", value="tab_climate",br(),
                                                                   column(width = 12,
                                                                          sidebarLayout(
                                                                            sidebarPanel(width=3,
                                                                                         hr(),
                                                                                         uiOutput("climate_input_1"),
                                                                                         hr(),
                                                                                         uiOutput("climate_input_2"),
                                                                                         
                                                                            ),
                                                                            mainPanel(width=9,
                                                                                      column(width=9,uiOutput("display_climate_spiral"))
                                                                                      
                                                                            ) # mainPanel end
                                                                            
                                                                          ) # sidebarLayout end
                                                                          
                                                                   ), #column close
                                                                   
                                                          ), #tabPanel 6 end
                                                          
                                                          ) #inner tabsetPanel end
                                                          
                                                          
                                                 ), #tabPanel end
                                                 
                                                
                                                 
                                                 tabPanel("Temperature", value="temp_tab",
                                                          tabsetPanel(id="temp_subtabs",
                                                                      tabPanel("Thermal statistics",value = "sb1",br(),
                                                                               br(),
                                                                               column(width=12,uiOutput("display_plot3"))
                                                                      ),
                                                                      tabPanel("Air vs Water",value = "sb2",br(),
                                                                               br(),
                                                                               column(width=12,uiOutput("display_plot4"))
                                                                      ),
                                                                      tabPanel("Growing degree days",value = "sb3",br(),
                                                                               br(),
                                                                               column(width=12,uiOutput("display_plot5"))
                                                                      ),
                                                                      tabPanel("Thermal classification",value = "sb5",br(),
                                                                               br(),
                                                                               column(width=12,uiOutput("display_plot6"))
                                                                      ))), #outer tabPanel end
                                                 
                                                 tabPanel("Hydrology", value="hydro_tab",
                                                          tabsetPanel(id="hydro_subtabs",
                                                                      tabPanel("IHA",value = "IHA_tab",br(),
                                                                               br(),
                                                                               column(width=12,uiOutput("display_plot7"))
                                                                      ),
                                                                     
                                                                      tabPanel("Flashiness",value = "Flashiness_tab",br(),
                                                                               br(),
                                                                               column(width=12,uiOutput("display_plot8"))
                                                                      )))  
                                                 
                                                 
                                  ) #tabsetPanel end              
                                  ) #fluidRow close
                                )  #fluidPage close
                       ),# tabPanel end 
                       
               tabPanel("Create Report",
                        fluidPage(
                                fluidRow(
                                  tabsetPanel(id="report_subtabs",
                                              tabPanel("SingleSite",value = "SingleSite_tab",br(),
                                                       br(),
                                                       column(width=12,uiOutput("display_table_single_site"))
                                              ), #tabPanel close
                                              
                                              tabPanel("MultiSites",value = "MultiSites_tab",br(),
                                                       br(),
                                                       column(width=12,uiOutput("display_table_multiple_sites"))
                                              ) #tabPanel close 
                                             ) #tabsetPanel end              
                                    ) #fluidRow end
                        ) #fluidPage end
               ) # tabPanel end 
                       
            ) #tabsetPanel close
            
            )
                     
  )
))
